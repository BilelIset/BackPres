<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="template">

<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>
    <link rel="stylesheet" href="/webjars/bootstrap/5.3.3/css/bootstrap.min.css">
    <script src="/webjars/bootstrap/5.3.3/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="/webjars/bootstrap-icons/1.10.5/font/bootstrap-icons.css">

</head>
<body>
<div layout:fragment="content1" style="margin-top:10px">
    <div class="card bg-primary">
        <div class="card-header bg-primary">
            <h2 style="color:white" th:text="'Tableau de bord : ' +${dateNow}"></h2>
        </div>
    </div>

<div class="container"> <table>
    <tr>

           <td> <h6 style="width:250px;color:white" th:class="${webServer}?' d-none':'blink text-danger'"
                th:text="${webServer}? 'Web : Actif':'Serveur Web  : Non Actif !'"></h6>

           </td><td>
            <h6 style="width:250px;color:white" th:class="${mailServer}?' d-none':'blink text-danger'"
                th:text="${mailServer}? 'Messagerie : Actif':'Serveur Messagerie  : Non Actif !'"></h6></td><td>
            <h6 style="width:250px;color:white" th:class="${mobileServer}?' d-none':'blink text-danger'"
                th:text="${mobileServer}? 'Mobile : Actif':' Serveur Mobile : Non Actif ! !'"></h6></td>

    </tr> </table></div>
    <div class="container-fluid">
        <table class="table table-bordered table-responsive" style="font-size:10px">
            <tr>
                <td style="width:60%; height:40%">
                    <div class="card">
                        <div class="card-header bg-info">
                            <h6>Aperçu des 5 derniers absences enseignants</h6>
                        </div>
                        <div class="card-body">
                            <table class="table table-striped">
                                <thead>
                                <tr>
                                    <th>Nom de salle</th>
                                    <th>Nom Matière</th>
                                    <th>Enseignant</th>
                                    <th>Nom De Séance</th>
                                    <th>Horaire</th>
                                    <th>Année</th>
                                    <th>Jour</th>
                                    <th>Date</th>
                                    <th>Notifié</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="abs : ${listAbsence}">
                                    <td th:text="${abs.nom_salle}"></td>
                                    <td th:text="${abs.nom_matiere}"></td>
                                    <td th:text="${abs.ensi1}"></td>
                                    <td th:text="${abs.nom_seance}"></td>
                                    <td th:text="${abs.seanceDouble}"></td>
                                    <td th:text="${abs.annee1}"></td>
                                    <td th:text="${abs.nom_jour}"></td>
                                    <td th:text="${abs.date}"></td>
                                    <td th:text="${abs.notified ? 'Oui' : 'Non'}"
                                        th:attr="style=(${abs.notified} ? 'color:green;' : 'color:red;')"></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </td>

                <td style="width:60%; height:40%">
                    <div class="card">
                        <div class="card-header bg-warning">
                            <h6>Enseignants non notifiés</h6>
                        </div>
                        <div class="card-body">
                            <table class="table table-striped">
                                <thead>
                                <tr>
                                    <th>Nom Matière</th>
                                    <th>Enseignant</th>
                                    <th>Horaire</th>
                                    <th>Date</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="abs : ${listAbsence}">
                                    <td th:text="${abs.nom_matiere}"></td>
                                    <td th:text="${abs.ensi1}"></td>
                                    <td th:text="${abs.nom_seance}"></td>
                                    <td th:text="${abs.date}"></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </td>
            </tr>

            <tr>
                <td class="table" style="width:50%; height:40%">
                    <div class="card">
                        <div class="card-header bg-secondary">
                            <h6 class="text-light bg-secondary">Utilisateurs connectés</h6>
                        </div>
                        <div class="card-body">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th>Source</th>
                                    <th>User name</th>
                                    <th>Role</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td>Web</td>
                                    <td>Bilel</td>
                                    <td>Admin</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </td>

                <td class="table" style="width:50%; height:40%">
                    <table class="table table-bordered table-responsive" style="font-size:10px">
                        <tr>
                            <td>
                                <table class="table">
                                    <tr>
                                        <td>
                                            <div class="card">
                                                <div class="card-header bg-secondary">
                                                    <h6 class="text-light">Absence Top 5</h6>
                                                </div>
                                                <div class="card-body">
                                                    <table class="table table-striped table-bordered">
                                                        <thead>
                                                        <tr class="text-secondary">
                                                            <th>Matricule</th>
                                                            <th>Absence</th>
                                                        </tr>
                                                        </thead>
                                                        <tbody>
                                                        <tr th:each="abs, status : ${absenceByEnseignant}" th:if="${status.index < 5}">
                                                            <td th:text="${abs[0]}"></td>
                                                            <td th:text="${abs[1]}"></td>
                                                        </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="card">
                                                <div class="card-header bg-secondary">
                                                    <h6 class="text-light">Statistique</h6>
                                                </div>
                                                <div class="card-body">
                                                    <table class="table table-striped table-bordered">
                                                        <tr>
                                                            <td>Département</td>
                                                            <td>5</td>
                                                        </tr>
                                                        <tr>
                                                            <td>Salles</td>
                                                            <td th:text="${nbSalles}"></td>
                                                        </tr>
                                                        <tr>
                                                            <td>Enseignants</td>
                                                            <td th:text="${nbEns}"></td>
                                                        </tr>
                                                        <tr>
                                                            <td>Etudiants</td>
                                                            <td>2000</td>
                                                        </tr>
                                                    </table>
                                                </div>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>
</div>
</body>
</html>
